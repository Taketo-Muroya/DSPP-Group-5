geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8), limits = c(0, 8),
low = "#f5f7fc", high = "#022fa1") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 5,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8), limits = c(0, 8),
low = "#f5f7fc", high = "#022fa1") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 5,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
library(ggrepel)
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#f5f7fc", high = "#022fa1") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#f5f7fc", high = "#022fa1") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#f5f7fc", high = "#022fa1") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 5,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#f5f7fc", high = "#022fa1") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 5,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
library(ggrepel)
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#540000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#540000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#540000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 5,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#540000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 5,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000") +
geom_text_repel(data = county_labels, inherit.aes = FALSE, size = 4,
aes(label=county, x = long_center, y = lat_center)) +theme_bw()
library(scales)
p <- ggplot(top_change_tbl, aes(x=fct_rev(`Crime Type`), y=`% Change`, fill=`Time Period`)) +
geom_bar(position="dodge", stat="identity") + coord_flip() +
scale_fill_manual(values=c( "#c5eb7f","#9ACA3C", "#71a803", "#003F5D")) +
theme_tufte() + guides(fill = guide_legend(reverse=TRUE)) +
scale_y_continuous(limits = c(-0.25, 1.2), labels = percent,
breaks = c(-0.2, 0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2)) +
labs(fill = NULL, x = NULL, y = "Percent Increase", title = "Top Changes in Crime (2014-2017)") +
theme(axis.ticks = element_blank(), panel.grid.major.x = element_line(color = "light grey"),
legend.position = "bottom", legend.text=element_text(size=10), axis.text=element_text(size=10))
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000") +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000") +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000") +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#ffffff", high = "#960000")  +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#960000")  +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414")  +theme_bw()
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414") +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$ABS_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414")  +theme_bw()
#ASB 2015-07
crime_by_region_201501 <- crime_by_region %>%
filter(Month=="2015-01")
ukpp_crime_201501 <- left_join(crime_by_region_201501, ukpp_year15, by = c("Falls.within" = "county"))
ukpp_crime_201501 <- transform(ukpp_crime_201501, ABS_Crime_Rate = `Anti-social behaviour`*1000 / pop2015)
ukpp_crime_201501
#Bike theft 2015-07
crime_by_region_201501 <- crime_by_region %>%
filter(Month=="2015-01")
ukpp_crime_201501 <- left_join(crime_by_region_201501, ukpp_year15, by = c("Falls.within" = "county"))
ukpp_crime_201501 <- transform(ukpp_crime_201501, BT_Crime_Rate = `Bike theft`*1000 / pop2015)
#Bicycle theft 2015-07
crime_by_region_201501 <- crime_by_region %>%
filter(Month=="2015-01")
ukpp_crime_201501 <- left_join(crime_by_region_201501, ukpp_year15, by = c("Falls.within" = "county"))
ukpp_crime_201501 <- transform(ukpp_crime_201501, BT_Crime_Rate = `Bicycle theft`*1000 / pop2015)
ukpp_crime_201501 <- ukpp_crime_201501[,c(1,2,4,18:25)]
ukpp_crime_201501
#Bicycle theft 2015-07
crime_by_region_201507 <- crime_by_region %>%
filter(Month=="2015-07")
ukpp_crime_201507 <- left_join(crime_by_region_201507, ukpp_year15, by = c("Falls.within" = "county"))
ukpp_crime_201507 <- transform(ukpp_crime_201507, BT_Crime_Rate = `Bicycle theft`*1000 / pop2015)
ukpp_crime_201507 <- ukpp_crime_201507[,c(1,2,4,18:25)]
ukpp_crime_201507
#Bicycle theft 2016-01
crime_by_region_201601 <- crime_by_region %>%
filter(Month=="2016-01")
ukpp_crime_201601 <- left_join(crime_by_region_201601, ukpp_year16, by = c("Falls.within" = "county"))
ukpp_crime_201601 <- transform(ukpp_crime_201601, BT_Crime_Rate = `Bicycle theft`*1000 / pop2016)
ukpp_crime_201601 <- ukpp_crime_201601[,c(1,2,4,18:25)]
ukpp_crime_201601
#Bicycle theft 2016-07
crime_by_region_201607 <- crime_by_region %>%
filter(Month=="2016-07")
ukpp_crime_201607 <- left_join(crime_by_region_201607, ukpp_year16, by = c("Falls.within" = "county"))
ukpp_crime_201607 <- transform(ukpp_crime_201607, BT_Crime_Rate = `Bicycle theft`*1000 / pop2016)
ukpp_crime_201607 <- ukpp_crime_201607[,c(1,2,4,18:25)]
ukpp_crime_201607
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414") +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 2,4,6,8,10), limits = c(0, 10),
low = "#008cff", high = "#ff1414") +theme_bw()
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2), limits = c(0, 0.23),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2), limits = c(0, 0.23),
low = "#008cff", high = "#ff1414") +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2), limits = c(0, 0.23),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2), limits = c(0, 0.23),
low = "#008cff", high = "#ff1414")  +theme_bw()
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Humberside"]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Humberside"]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Humberside",]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Humberside Police",]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Northhamptonshire Police",]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Northhamptonshire Constabulary",]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Northamptonshire Constabulary",]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Northamptonshire Police",]
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2, 0.25), limits = c(0, 0.27),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2, 0.25), limits = c(0, 0.27),
low = "#008cff", high = "#ff1414") +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2, 0.25), limits = c(0, 0.27),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", breaks=c(0, 0.05, 0.1, 0.15, 0.2, 0.25), limits = c(0, 0.27),
low = "#008cff", high = "#ff1414")  +theme_bw()
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Cambridgeshire Police",]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Cambridgeshire Police",]
ukpp_crime_201507[ukpp_crime_201507$Falls.within=="Cambridgeshire Constabulary",]
ukpp_crime_201607[ukpp_crime_201507$Falls.within=="Cambridgeshire Constabulary",]
#winter 2015
ggplot() +
geom_polygon(data = ukpp_crime_201501, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201501$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", limits = c(0, 0.43),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer2015
ggplot() +
geom_polygon(data = ukpp_crime_201507, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201507$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", limits = c(0, 0.43),
low = "#008cff", high = "#ff1414") +theme_bw()
#winter 2016
ggplot() +
geom_polygon(data = ukpp_crime_201601, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201601$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", limits = c(0, 0.43),
low = "#008cff", high = "#ff1414") +theme_bw()
#summer 2016
ggplot() +
geom_polygon(data = ukpp_crime_201607, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201607$BT_Crime_Rate)) +
scale_fill_gradient(name="Crimes per Thousand", limits = c(0, 0.43),
low = "#008cff", high = "#ff1414")  +theme_bw()
# TODO: reshape data so that columns are "Crime Type" "Change Y1" "Change Y2" "Change Y3", "Change Overall". create a data table or line graph showing crimes that have an overall % change of more than 10%, include "all"
# export data to excel, where % change per crime type is calculated
# for year-to-year and over the three years and new dataset is read in
#write_csv(crime_freq_by_month, "crime_freq_by_month.csv")
crime_change_by_type <- read_csv("crime_change_by_type.csv")
# reduce dataset down to relevant variables and only 8 types with largest absolute change in crime
crime_change_by_type <- crime_change_by_type %>%
.[,c(1,4,6)]
top_change_types <- crime_change_by_type$`Crime Type`[1:8]
top_change_tbl <- crime_change_by_type[crime_change_by_type$`Crime Type` %in% top_change_types, ]
# make "Crime Type" an ordered factor variable for graphing
top_change_tbl$`Crime Type` <- factor(top_change_tbl$`Crime Type`, levels= top_change_tbl$`Crime Type`[1:8])
top_change_tbl
library(scales)
p <- ggplot(top_change_tbl, aes(x=fct_rev(`Crime Type`), y=`% Change`, fill=`Time Period`)) +
geom_bar(position="dodge", stat="identity") + coord_flip() +
scale_fill_manual(values=c( "#c5eb7f","#9ACA3C", "#71a803", "#003F5D")) +
theme_tufte() + guides(fill = guide_legend(reverse=TRUE)) +
scale_y_continuous(limits = c(-0.25, 1.2), labels = percent,
breaks = c(-0.2, 0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2)) +
labs(fill = NULL, x = NULL, y = "Percent Increase", title = "Top Changes in Crime (2014-2017)") +
theme(axis.ticks = element_blank(), panel.grid.major.x = element_line(color = "light grey"),
legend.position = "bottom", legend.text=element_text(size=10), axis.text=element_text(size=10))
p
library(scales)
p <- ggplot(top_change_tbl, aes(x=fct_rev(`Crime Type`), y=`% Change`, fill=`Time Period`)) +
geom_bar(position="dodge", stat="identity") + coord_flip() +
scale_fill_manual(values=c( "#c5eb7f","#9ACA3C", "#71a803", "#003F5D")) +
theme_tufte() + guides(fill = guide_legend(reverse=TRUE)) +
scale_y_continuous(limits = c(-0.25, 1.2), labels = percent,
breaks = c(-0.2, 0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2)) +
labs(fill = NULL, x = NULL, y = "Percent Increase", title = "Top Changes in Crime (2014-2017)") +
theme(axis.ticks = element_blank(), panel.grid.major.x = element_line(color = "light grey"),
legend.position = "bottom", legend.text=element_text(size=10), axis.text=element_text(size=10))
p
library(scales)
p <- ggplot(top_change_tbl, aes(x=fct_rev(`Crime Type`), y=`% Change`, fill=`Time Period`)) +
geom_bar(position="dodge", stat="identity") + coord_flip() +
scale_fill_manual(values=c( "#c5eb7f","#9ACA3C", "#71a803", "#003F5D")) +
theme_tufte() + guides(fill = guide_legend(reverse=TRUE)) +
scale_y_continuous(limits = c(-0.25, 1.2), labels = percent,
breaks = c(-0.2, 0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2)) +
labs(fill = NULL, x = NULL, y = "Percent Increase", title = "Top Changes in Crime (2014-2017)") +
theme(axis.ticks = element_blank(), panel.grid.major.x = element_line(color = "light grey"),
legend.position = "bottom", legend.text=element_text(size=12), axis.text=element_text(size=12))
p
# read in population data
pop <- read_csv("Population by year.csv")
ukpp_year14 <- left_join(pop, ukpp2, by = "county")[,c(1,2,5:10)]
ukpp_year14
ukpp_year15 <- left_join(pop, ukpp2, by = "county")[,c(1,3,5:10)]
ukpp_year15$pop2015 <- as.numeric(ukpp_year15$pop2015)
ukpp_year16 <- left_join(pop, ukpp2, by = "county")[,c(1,4,5:10)]
ukpp_year16
#no major changes in population in any PFA (most change was 3% from 2014 to 2016), so I'll just use the raw counts.
#Public order 2014-10
crime_by_region_201410 <- crime_by_region %>%
filter(Month=="2014-10")
ukpp_crime_201410 <- left_join(crime_by_region_201410, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201410
ukpp_crime_201410 <- ukpp_crime_201410[,c(1,2,4,18:25)]
#no major changes in population in any PFA (most change was 3% from 2014 to 2016), so I'll just use the raw counts.
#Public order 2014-10
crime_by_region_201410 <- crime_by_region %>%
filter(Month=="2014-10")
ukpp_crime_201410 <- left_join(crime_by_region_201410, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201410 <- ukpp_crime_201410[,c(1,2,11,21:23)]
ukpp_crime_201410
#no major changes in population in any PFA (most change was 3% from 2014 to 2016), so I'll just use the raw counts.
#Public order 2014-10
crime_by_region_201410 <- crime_by_region %>%
filter(Month=="2014-10")
ukpp_crime_201410 <- left_join(crime_by_region_201410, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201410 <- ukpp_crime_201410[,c(1,2,11,21:23)]
ukpp_crime_201410
#Public order 2017-09
crime_by_region_201709 <- crime_by_region %>%
filter(Month=="2017-09")
ukpp_crime_201709 <- left_join(crime_by_region_201709, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201709 <- ukpp_crime_201709[,c(1,2,11,21:23)]
ukpp_crime_201709
max(ukpp_crime_201709$`Public order`)
# 2014-10
ggplot() +
geom_polygon(data = ukpp_crime_201410, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201410$`Public order`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 4500),
low = "#008cff", high = "#ff1414") +theme_bw()
#no major changes in population in any PFA (most change was 3% from 2014 to 2016), so I'll just use the raw counts.
#Public order 2014-10
crime_by_region_201410 <- crime_by_region %>%
filter(Month=="2014-10")
ukpp_crime_201410 <- left_join(crime_by_region_201410, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201410
ukpp_crime_201410 <- ukpp_crime_201410[,c(1,2,11,21:23)]
ukpp_crime_201410
#Public order 2017-09
crime_by_region_201709 <- crime_by_region %>%
filter(Month=="2017-09")
ukpp_crime_201709 <- left_join(crime_by_region_201709, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201709 <- ukpp_crime_201709[,c(1,2,11,21:23)]
ukpp_crime_201709
#no major changes in population in any PFA (most change was 3% from 2014 to 2016), so I'll just use the raw counts.
#Public order 2014-10
crime_by_region_201410 <- crime_by_region %>%
filter(Month=="2014-10")
ukpp_crime_201410 <- left_join(crime_by_region_201410, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201410 <- ukpp_crime_201410[,c(1,2,11,18:23)]
ukpp_crime_201410
#Public order 2017-09
crime_by_region_201709 <- crime_by_region %>%
filter(Month=="2017-09")
ukpp_crime_201709 <- left_join(crime_by_region_201709, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201709 <- ukpp_crime_201709[,c(1,2,11,18:23)]
ukpp_crime_201709
# 2014-10
ggplot() +
geom_polygon(data = ukpp_crime_201410, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201410$`Public order`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 4500),
low = "#008cff", high = "#ff1414") +theme_bw()
# 2017-09
ggplot() +
geom_polygon(data = ukpp_crime_201709, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201709$`Public order`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 4500),
low = "#008cff", high = "#ff1414") +theme_bw()
# 2014-10
ggplot() +
geom_polygon(data = ukpp_crime_201410, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201410$`Public order`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 4500),
low = "#ffffff", high = "firebrick") +theme_bw()
# 2017-09
ggplot() +
geom_polygon(data = ukpp_crime_201709, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_crime_201709$`Public order`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 4500),
low = "#ffffff", high = "firebrick") +theme_bw()
#Posession of weapons 2014-10
crime_by_region_201410 <- crime_by_region %>%
filter(Month=="2014-10")
ukpp_crime_201410 <- left_join(crime_by_region_201410, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201410
ukpp_crime_201410 <- ukpp_crime_201410[,c(1,2,11,18:23)]
ukpp_crime_201410
#Posession of weapons 2017-09
crime_by_region_201709 <- crime_by_region %>%
filter(Month=="2017-09")
ukpp_crime_201709 <- left_join(crime_by_region_201709, ukpp2, by = c("Falls.within" = "county"))
ukpp_crime_201709 <- ukpp_crime_201709[,c(1,2,11,18:23)]
ukpp_crime_201709
#Posession of weapons 2014-10
crime_by_region_201410 <- crime_by_region %>%
filter(Month=="2014-10")
ukpp_weapons_201410 <- left_join(crime_by_region_201410, ukpp2, by = c("Falls.within" = "county"))
ukpp_weapons_201410 <- ukpp_weapons_201410[,c(1,2,10,18:23)]
ukpp_weapons_201410
#Posession of weapons 2017-09
crime_by_region_201709 <- crime_by_region %>%
filter(Month=="2017-09")
ukpp_weapons_201709 <- left_join(crime_by_region_201709, ukpp2, by = c("Falls.within" = "county"))
ukpp_weapons_201709 <- ukpp_weapons_201709[,c(1,2,10,18:23)]
ukpp_weapons_201709
# 2014-10
ggplot() +
geom_polygon(data = ukpp_weapons_201410, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_weapons_201410$`Public order`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 4500),
low = "#ffffff", high = "firebrick") +theme_bw()
# 2017-09
ggplot() +
geom_polygon(data = ukpp_weapons_201709, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_weapons_201709$`Public order`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 4500),
low = "#ffffff", high = "firebrick") +theme_bw()
max(ukpp_weapons_201709$`Possession of weapons`)
# 2014-10
ggplot() +
geom_polygon(data = ukpp_weapons_201410, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_weapons_201410$`Possession of weapons`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 600),
low = "#ffffff", high = "firebrick") +theme_bw()
# 2017-09
ggplot() +
geom_polygon(data = ukpp_weapons_201709, color = "dark grey", size = 0.4,
aes(x = long, y = lat, group=group, fill =ukpp_weapons_201709$`Possession of weapons`)) +
scale_fill_gradient(name="Number of Crimes", limits = c(0, 600),
low = "#ffffff", high = "firebrick") +theme_bw()
